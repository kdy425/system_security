import subprocess
import tkinter as tk
from tkinter import messagebox

class ProcessViewerApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Process Viewer with Malware Scanner")

        # 악성코드 검사 버튼 생성
        self.scan_button = tk.Button(root, text="악성코드 검사", command=self.launch_malware_scanner)
        self.scan_button.pack(pady=20)

    def launch_malware_scanner(self):
        try:
            # Microsoft Windows 악성 소프트웨어 제거 도구의 실행 경로
            malware_scanner_path = r'C:\Windows\System32\MRT.exe'

            # 악성코드 검사 도구 실행
            subprocess.run([malware_scanner_path], shell=True)
        except Exception as e:
            messagebox.showerror("오류", f"악성코드 검사 도구를 실행하는 중 오류가 발생했습니다: {str(e)}")

if __name__ == "__main__":
    root = tk.Tk()
    app = ProcessViewerApp(root)
    root.mainloop()
